using CairoMakie
# using Polynomials
using Interpolations
# using BSplines

widthSeries = Dict()
widthSeries[1]  = [334.61,410.65,276.59,274.1,194.8,324.52,145.65,220.66,151.45,328.3,203.41,160.19,198.11,159.49,]
widthSeries[2]  = [248.7,294.23,137.33,204.43,181.61,210.76,155.34,144.87,233.67,263.66,267.33,366.02,437.2,444.44,233.31,215.25]
widthSeries[3]  = [121.6,167.98,144.6,166.71,144.94,174.44,122.07,197.9]
widthSeries[4]  = [189.43,467.9,249.99,231.76,230.41,365.46,249.32,403.66]
widthSeries[5]  = [289.94,135.4,192.3,246.31,281.21,88.74,233.2,199.96,121.88,216.5,160.82,389.08]
widthSeries[6]  = [412.24,222.14,230.41,188.23,203.75,235.1,156.88,213.57,154.8,190.19,134.64,141.15,176.6]
widthSeries[7]  = [144.31,247.23,178.45,134.73,113.04,154.52,189.77,140.59,164.31,212.51]
widthSeries[8]  = [321.27,345.07,204.4,291.86,179.95,336.17,350.56,329.72,255.85,340.95,587.35,362.16,475.99,271.83]
widthSeries[9]  = [283.16,242.51,218.48,327.83]
widthSeries[10] = [283.16,132.76,197.48,190.65,150.91,221.32]
widthSeries[11] = [292.64,380.47,115.15,145.65,142.4,291.58,142.41]
widthSeries[12] = [464.92,276.38,200.21,204.7,495.78,704.9,217.59]
widthSeries[13] = [204.69,157.5,105.08,156.54,113.39,184.48,88.69,238.8,297.47]
widthSeries[14] = [255.92,192.12,280.46,121.75,130.74,187.73,170.86,154.1]
widthSeries[15] = [524.4,474.74,504.85,423.2,288.17]
widthSeries[16] = [497.39,610.97,672.12,627.09,617.07]
widthSeries[17] = [296.87,249.79,195.1,212.69,180.13,242.51,402.2]
widthSeries[18] = [406.82,218.48,265.53,256.27,142.4,150.39,201.39]
widthSeries[19] = [452.44,209.22,189.64,210.38,223.14,205.69]
widthSeries[20] = [315.05,308.53,376.9,246.36,153.61,185.73,279.77]
widthSeries[21] = [421.15,431.64,550.3,525.95]
widthSeries[22] = [269.06,369.57,436.48,264.06,358.01,182.27,376.71,292.08,243.87,346.36,111.85]
widthSeries[23] = [1019.57,366.78,441.15,289.97,149.51]
widthSeries[24] = [243.45,103.26,192.13,132.03,128.88,200.49,160.11,158.17,129.68,243.87]
widthSeries[25] = [391.58,142.41,144.31,205.59,187.22,333.99,497.84]
widthSeries[26] = [491.83,381.21,266.92,426.38,387.12,371.42,358.48]
widthSeries[27] = [283.4,175.25,186.98,219.95,153.7,164.96]
widthSeries[28] = [385.9,167.24,138.16,250.86,192.95,172.25,153.7,140.19]
widthSeries[29] = [160.31,350.48,283.06,191.47,183.4,234.1,240.08,180.81]
widthSeries[30] = [307.21,238.19,184.65,192.6,261.14,362.59,458.89,451.09]
widthSeries[31] = [155.81,222.2,136.19,211.5,188.31,188.3,175.61,175.61,343.67,357.29,421.07]
widthSeries[32] = [313.53,215.34,206.95,288.9,257.99,416.84,163.49,234.73,350.35,505.55]
widthSeries[33] = [201.6,245.52,380.22,273.39,386.98,373.71]
widthSeries[34] = [299.84,173.31,248.18,222.6,182.31,148.18,197.94,213.15,248.18,167.95]
widthSeries[35] = [251.85,234.6,209.19,237.51,127.12,144.53,186.05,149.2,205.15,197.59]
widthSeries[36] = [164.73,209.91,188.88,179.79,215.64,179.79,185.63,172.87,167.94,346.38,296.34,261.93]
widthSeries[37] = [552.21,288.26,247.26,174.63,210.27,236.96]
widthSeries[38] = [326.25,249.98,195.94,221.68,228.51,209.07,239.12,213.54,261.76,272.59]
widthSeries[39] = [200.41,206.23,216.56,196.84,195.94,164.48,141.71,209.06,206.51,229.28,163.4,206.8,206.8,247.85,141.71,187.6]
widthSeries[40] = [243.04,228.25,206.51,179.91,293.66,152.55,218.46,153.71,164.47,155.62,174.24,224.07]
widthSeries[41] = [316.88,316.88,295.27,206.23,221.68,261.76,293.46,240.1,304.53,321.88,273.67,370.18,249.98,369.7]
widthSeries[42] = [180.91,175.89,221.38,188.5,227.52,287.05,291.29]
widthSeries[43] = [161.36,123.76,123.76,166.04,141.1,133.29,149.54,172.38]
widthSeries[44] = [178.84,175.89,141.11,175.9,204.86,243.77,238.05,204.86]
widthSeries[45] = [161.36,166.04,193.31,219.3,195.68,161.36]
widthSeries[46] = [248.59,229.15,355.56,357.83,242.01,317.77,264.34,185.29,242.84]
widthSeries[47] = [296.74,142.11,156.97,285.64,172.89,162.03,298.77,396.39,327.17,468.75,425.86,422.53,285.64,206.92,486.51,423.9]
widthSeries[48] = [213.64,273.36,156.96,134.82,179.76,156.97,217.39,279.2,327.17,224.7,298.77,307.43]
widthSeries[49] = [262.04,170.54,234.38,127.11,224.7,635.54,555.87,351.56,427.28,292.63]
widthSeries[50] = [335.48,420.04,514.6,646.07]
widthSeries[51] = [163.75,182.85,182.85,182.85]
widthSeries[52] = [224.1,212.95,207.45,219.04]
widthSeries[53] = [670.96,556.63,628.15,1054.78]
widthSeries[54] = [151.45,302.01,503.91,876.66]
widthSeries[55] = [180.71,262.84]
widthSeries[56] = [318.17,248.6,187.3,302.01]
widthSeries[57] = [183.65,169.13,205.84,311.69]
widthSeries[58] = [1168.18,1217.39,296.14]
widthSeries[59] = [287.35,190.1,256.8,406.04]
widthSeries[60] = [162.42,185.18,197.59,194.5,167.22,138.77]
widthSeries[61] = [312.41,232.54,162.41,262.39,287.01]
widthSeries[62] = [815.65,627.36,661.14,276.11]

fig = Figure()
ax = Axis(fig[1,1])
for y=1:10
    
    xs = 1:length(widthSeries[y])

    # itp_linear = linear_interpolation(x, y)
    itp_cubic = cubic_spline_interpolation(xs, widthSeries[y])

    # Interpolation functions
    # f_linear(x) = itp_linear(x)
    f_cubic(x) = itp_cubic(x)

    # p = fit(xs, widthSeries[y], 3)
    
    scatter!(ax, xs, widthSeries[y])
    plotXs = collect(range(xs[1], xs[end], length=100))
    lines!(ax, plotXs, f_cubic.(plotXs))
end

display(fig)

# save("widthFits.png",fig)


#%%



